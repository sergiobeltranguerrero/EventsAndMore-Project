{% extends "base.html" %}
{% block title %}Eventos disponibles{% endblock %}
{% block body %}
<h1>Eventos disponibles</h1>
<div class="container">
    <form action="{% url 'filter_events' %}" method="POST">
        {% csrf_token %}
        <div class="col-9 col-sm-8 col-md-6 col-lg-5 col-xl-4">
            <div class="input-group">
                <label class="input-group-text" for="inputGroupMonth">Mes</label>
                <input type="number" class="form-control" id="month" aria-describedby="inputGroupMonth" max="12" min="1" value="{{ fecha_now.month }}" maxlength="2">
                <label class="input-group-text" for="inputGroupMonth">Ano</label>
                <input type="number" class="form-control" id="year" aria-describedby="inputGroupMonth"  min="{{ fecha_now.year|add:-1 }}" value="{{ fecha_now.year }}" max="{{fecha_now.year|add:5}}" maxlength="4">
                <button class="btn  btn-secondary" type="button" id="inputGroupMonth">Filtrar</button>
            </div>
        </div>
        <div class="col-12">
            <div class="input-group">
                <label class="input-group-text" for="inputGroupDate">Rango</label>
                <label class="input-group-text" for="inputGroupDate">Fecha inicio</label>
                <input type="date" class="form-control" id="date_start_start" name="date_start_start" aria-describedby="inputGroupDate" min="{{ mindate|date:'Y-m-d' }}" value="{{ date_start_start|date:'Y-m-d' }}">
                <input type="date" class="form-control" id="date_start_end" name="date_start_end" aria-describedby="inputGroupDate" max="{{ maxdate|date:'Y-m-d' }}" value="{{ date_start_end|date:'Y-m-d' }}">
            </div>
        </div>
        <div class="col-12">
            <div class="input-group">
                <label class="input-group-text" for="inputGroupDate">Rango</label>
                <label class="input-group-text" for="inputGroupDate">Fecha fin&nbsp;&nbsp;&nbsp;&nbsp;</label>
                <input type="date" class="form-control" id="start_date_end" name="date_end_start" aria-describedby="inputGroupDate" min="{{ mindate|date:'Y-m-d' }}" value="{{ date_end_start|date:'Y-m-d' }}">
                <input type="date" class="form-control" id="end_date_end" name="date_end_end" aria-describedby="inputGroupDate" max="{{ maxdate|date:'Y-m-d' }}" value="{{ date_end_end|date:'Y-m-d' }}">
            </div>
        </div>
        <div class="input-group">
            <button class="btn  btn-secondary" type="submit" id="filter">Filtrar</button>
        </div>
    </form>
    <form action="{% url 'list_events' %}" method="POST">
    {% csrf_token %}
        <table class="table table-striped table-hover col-12">
            <thead>
                <tr>
                    <th hidden>IdEvent</th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Fecha inicio</th>
                    <th scope="col">Fecha fin</th>
                    <th scope="col">Capacidad</th>
                    <th scope="col" colspan="2">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for evento in eventos %}
                    <tr>
                        <th scope="row" hidden><input type="number" id="id_evento{{evento.id}}" name="id_evento{{evento.id}}" value="{{evento.id}}" readonly required/></th>
                        <td>{{evento.nombre}}</td>
                        <td>{{evento.fecha_inicio|date:"d/m/Y H:i"}}</td>
                        <td>{{evento.fecha_fin|date:"d/m/Y H:i"}}</td>
                        <td>{{evento.capacidad}}</td>
                        <td>
                            <div class="form-group">
                                <a class="btn btn-primary btn-block text-black" href="{% url 'detail_event' evento.id %}">Detalle</a>
                            </div>
                        </td>
                        <td>
                            <div class="form-group">
                                <a class="btn btn-success btn-block text-black" href="{% url 'get_stand' evento.id %}">Unirme</a>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </form>
</div>
{% endblock %}